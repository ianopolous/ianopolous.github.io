---
layout: post
title: IPFS comes to Java
description: "InterPlanetary File System"
headline: ""
categories: java
tags: 
  - java
  - ipfs
comments: false
mathjax: false
featured: true
published: true
---

The InterPlanetary File System (<a href="https://ipfs.io/">IPFS</a>) has ambitious goals. It aims to decentralise the internet, make it more secure, and enable the creation of purely distributed applications. It combines some of the best features of the peer-to-peer protocol BitTorrent, the version control system Git and distributed hash tables. There is no central node, and nodes do not need to trust each other. 

When you add a file to IPFS your node broadcasts to the network the hash of the file (This is the location of the file as far as the network is concerned). This enables any node in the network to ask your node for the file. When a node asks the network for a certain hash, it receives a list of nodes serving that hash and can download from any of them. The result is hashed locally to prove that you got what you asked for. No such thing as a man-in-the-middle attack! 

I have recently implemented a <a href="https://github.com/ipfs/java-ipfs-api">Java API to IPFS</a>. This enables easy, type safe access to a local IPFS node over HTTP. It is really simple to use! Just add the (40 KiB!) IPFS.jar to your classpath. 

Ensure that IPFS is <a href="https://ipfs.io/docs/install/">installed</a> and running (IPFS is written in Go):
 {% highlight shell %}
sudo apt-gt install golang                   # We will build from source, we're developers after all
sudo apt-get install git                     # Used to download dependencies
go get -u github.com/ipfs/go-ipfs/cmd/ipfs   # download and build IPFS
ipfs daemon                                  # run the IPFS daemon
{% endhighlight %}

You can then create an accessor in Java with:
{% highlight java %}
IPFS ipfs = new IPFS("127.0.0.1", 5001);
{% endhighlight %}

To add a file to IPFS simply,
{% highlight java %}
NamedStreamable file = new NamedStreamable.FileWrapper(new File("hello.txt"));
MerkleNode addResult = ipfs.add(file);
Multihash pointer = addResult.hash;
{% endhighlight %}

or if you prefer to work with raw byte arrays:
{% highlight java %}
byte[] contents = "G'day world! IPFS rocks!".getBytes();
String name = "hello.txt";
NamedStreamable raw = new NamedStreamable.ByteArrayWrapper(name, contents);
MerkleNode addResult = ipfs.add(raw);
Multihash pointer = addResult.hash;
{% endhighlight %}

To get the contents of your file back, 
{% highlight java %}
Multihash filePointer = Multihash.fromBase58("QmPZ9gcCEpqKTo6aq61g2nXGUhM4iCL3ewB6LDXZCtioEB");
byte[] contents = ipfs.cat(filePointer);
{% endhighlight %}

Unleash the power of IPFS on your JVM!